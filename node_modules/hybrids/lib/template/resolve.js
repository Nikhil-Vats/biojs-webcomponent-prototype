"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = resolve;
var promiseMap = new WeakMap();

function resolve(promise, placeholder) {
  var delay = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 200;
  return function (host, target) {
    var timeout;

    if (placeholder) {
      timeout = setTimeout(function () {
        timeout = undefined;
        requestAnimationFrame(function () {
          placeholder(host, target);
        });
      }, delay);
    }

    promiseMap.set(target, promise);
    promise.then(function (template) {
      if (timeout) clearTimeout(timeout);

      if (promiseMap.get(target) === promise) {
        template(host, target);
        promiseMap.set(target, null);
      }
    });
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy90ZW1wbGF0ZS9yZXNvbHZlLmpzIl0sIm5hbWVzIjpbInByb21pc2VNYXAiLCJXZWFrTWFwIiwicmVzb2x2ZSIsInByb21pc2UiLCJwbGFjZWhvbGRlciIsImRlbGF5IiwiaG9zdCIsInRhcmdldCIsInRpbWVvdXQiLCJzZXRUaW1lb3V0IiwidW5kZWZpbmVkIiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwic2V0IiwidGhlbiIsInRlbXBsYXRlIiwiY2xlYXJUaW1lb3V0IiwiZ2V0Il0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFNQSxVQUFVLEdBQUcsSUFBSUMsT0FBSixFQUFuQjs7QUFFZSxTQUFTQyxPQUFULENBQWlCQyxPQUFqQixFQUEwQkMsV0FBMUIsRUFBb0Q7QUFBQSxNQUFiQyxLQUFhLHVFQUFMLEdBQUs7QUFDakUsU0FBTyxVQUFDQyxJQUFELEVBQU9DLE1BQVAsRUFBa0I7QUFDdkIsUUFBSUMsT0FBSjs7QUFFQSxRQUFJSixXQUFKLEVBQWlCO0FBQ2ZJLE1BQUFBLE9BQU8sR0FBR0MsVUFBVSxDQUFDLFlBQU07QUFDekJELFFBQUFBLE9BQU8sR0FBR0UsU0FBVjtBQUVBQyxRQUFBQSxxQkFBcUIsQ0FBQyxZQUFNO0FBQzFCUCxVQUFBQSxXQUFXLENBQUNFLElBQUQsRUFBT0MsTUFBUCxDQUFYO0FBQ0QsU0FGb0IsQ0FBckI7QUFHRCxPQU5tQixFQU1qQkYsS0FOaUIsQ0FBcEI7QUFPRDs7QUFFREwsSUFBQUEsVUFBVSxDQUFDWSxHQUFYLENBQWVMLE1BQWYsRUFBdUJKLE9BQXZCO0FBRUFBLElBQUFBLE9BQU8sQ0FBQ1UsSUFBUixDQUFhLFVBQUNDLFFBQUQsRUFBYztBQUN6QixVQUFJTixPQUFKLEVBQWFPLFlBQVksQ0FBQ1AsT0FBRCxDQUFaOztBQUViLFVBQUlSLFVBQVUsQ0FBQ2dCLEdBQVgsQ0FBZVQsTUFBZixNQUEyQkosT0FBL0IsRUFBd0M7QUFDdENXLFFBQUFBLFFBQVEsQ0FBQ1IsSUFBRCxFQUFPQyxNQUFQLENBQVI7QUFDQVAsUUFBQUEsVUFBVSxDQUFDWSxHQUFYLENBQWVMLE1BQWYsRUFBdUIsSUFBdkI7QUFDRDtBQUNGLEtBUEQ7QUFRRCxHQXZCRDtBQXdCRCIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHByb21pc2VNYXAgPSBuZXcgV2Vha01hcCgpO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiByZXNvbHZlKHByb21pc2UsIHBsYWNlaG9sZGVyLCBkZWxheSA9IDIwMCkge1xuICByZXR1cm4gKGhvc3QsIHRhcmdldCkgPT4ge1xuICAgIGxldCB0aW1lb3V0O1xuXG4gICAgaWYgKHBsYWNlaG9sZGVyKSB7XG4gICAgICB0aW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIHRpbWVvdXQgPSB1bmRlZmluZWQ7XG5cbiAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHtcbiAgICAgICAgICBwbGFjZWhvbGRlcihob3N0LCB0YXJnZXQpO1xuICAgICAgICB9KTtcbiAgICAgIH0sIGRlbGF5KTtcbiAgICB9XG5cbiAgICBwcm9taXNlTWFwLnNldCh0YXJnZXQsIHByb21pc2UpO1xuXG4gICAgcHJvbWlzZS50aGVuKCh0ZW1wbGF0ZSkgPT4ge1xuICAgICAgaWYgKHRpbWVvdXQpIGNsZWFyVGltZW91dCh0aW1lb3V0KTtcblxuICAgICAgaWYgKHByb21pc2VNYXAuZ2V0KHRhcmdldCkgPT09IHByb21pc2UpIHtcbiAgICAgICAgdGVtcGxhdGUoaG9zdCwgdGFyZ2V0KTtcbiAgICAgICAgcHJvbWlzZU1hcC5zZXQodGFyZ2V0LCBudWxsKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcbn1cbiJdfQ==